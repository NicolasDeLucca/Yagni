# ADR 008 - Uso de RabbitMQ como Message Broker para Notificaciones y Sincronización

**Estado**: Aprobado.

## Contexto:

YAGNI necesita implementar un mecanismo de comunicación eficiente y confiable entre diferentes componentes del sistema, especialmente para las **notificaciones entre las cocinas, locales de retiro, y usuarios**.

RabbitMQ ha sido propuesto como la solución de **Message Broker** para gestionar esta comunicación, actuando como intermediario para el intercambio de mensajes entre los servicios y aplicaciones.

## Decisión:

Se decide utilizar **RabbitMQ** como Message Broker para gestionar notificaciones en tiempo real entre los componentes del sistema para una coordinación eficiente. Especialmente haciendo énfasis en el **estado de los pedidos en tiempo real** durante todo el flujo, y también para el **envío de las claves OTP** para el manejo de puertas de los refrigeradores. 
   
### Justificación:

- RabbitMQ permite el enrutamiento asíncrono de mensajes, reduciendo el acoplamiento entre los servicios y proporcionando un modelo de comunicación más robusto que soporta colas y distribuciones de mensajes eficientes.
- Mejora la escalabilidad del sistema YAGNI, ya que RabbitMQ puede gestionar múltiples flujos de mensajes en paralelo sin afectar el rendimiento de los servicios.

## Atributos de Calidad Satisfechos:

1. **Disponibilidad**: RabbitMQ garantiza que los mensajes sean entregados incluso en situaciones de alta carga, ayudando a mantener los tiempos de respuesta establecidos.
2. **Escalabilidad**: El uso de RabbitMQ permite la expansión del sistema sin afectar su capacidad de procesar notificaciones o sincronizar datos. Por ende, facilita la escalabilidad de la arquitectura de los microservicios.
3. **Performance**: Facilita la comunicación eficiente entre servicios y mejora el rendimiento del sistema al procesar mensajes de manera asincrónica.
4. **Seguridad**: La persistencia de mensajes garantiza la fiabilidad en las entregas, reduciendo la pérdida de datos.

## Ventajas:

1. **Desacoplamiento**: RabbitMQ desacopla los servicios, permitiendo que se comuniquen sin depender directamente entre sí.
2. **Manejo eficiente de cargas**: RabbitMQ gestiona grandes volúmenes de mensajes, distribuyendo la carga de manera eficiente entre los componentes.
3. **Soporte para mensajes persistentes**: Las colas de mensajes persistentes aseguran que no se pierdan notificaciones ni actualizaciones importantes.
4. **Eficiencia**: RabbitMQ puede manejar múltiples colas y rutas de mensajes en paralelo.

## Desventajas:

1. **Complejidad adicional**: La integración de RabbitMQ añade complejidad al sistema, ya que requiere su propio mantenimiento y configuración.
2. **Latencia potencial**: En escenarios con muchas colas o grandes volúmenes de mensajes, la latencia de procesamiento podría aumentar.
3. **Sobrecarga en la infraestructura**: Necesita infraestructura adicional para garantizar alta disponibilidad, lo que puede aumentar los costos y la complejidad operativa.
